spriteset(spriteset_BR380_Purchase, "gfx/EMU/380.png") {
    template_purchase(0, 0)
}
spriteset (spriteset_BR380_front_ScotRail_Saltire, "gfx/EMU/380.png") {         template_train32px(0, 13) }
spriteset (spriteset_BR380_middle_ScotRail_Saltire, "gfx/EMU/380.png") {        template_train32px(0, 65) }
spriteset (spriteset_BR380_middle_panto_ScotRail_Saltire, "gfx/EMU/380.png") {  template_train32px(0, 91) }
spriteset (spriteset_BR380_rear_ScotRail_Saltire, "gfx/EMU/380.png") {          template_train32px(0, 39) }
spriteset (spriteset_BR380_front_ScotRail_Saltire_reversed, "gfx/EMU/380.png") {         template_train32px_reversed(0, 117) }
spriteset (spriteset_BR380_middle_panto_ScotRail_Saltire_reversed, "gfx/EMU/380.png") {  template_train32px_reversed(0, 91) }
spriteset (spriteset_BR380_rear_ScotRail_Saltire_reversed, "gfx/EMU/380.png") {          template_train32px_reversed(0, 143) }

switch(FEAT_TRAINS, SELF, sw_BR380_cargo_subtype_text, cargo_subtype){
    0:  return string(str_ScotRailSaltire);
    return CB_RESULT_NO_TEXT;
}

// Normal-role mapper based on current vehicle type.
switch(FEAT_TRAINS, SELF, sw_BR380_role_from_vehicle, vehicle_type_id) {
    767:  spriteset_BR380_front_ScotRail_Saltire;
    768:  spriteset_BR380_front_ScotRail_Saltire;
    769:  spriteset_BR380_middle_panto_ScotRail_Saltire;
    770:  spriteset_BR380_rear_ScotRail_Saltire;
    771:  spriteset_BR380_middle_ScotRail_Saltire;
    772:  spriteset_BR380_middle_panto_ScotRail_Saltire;
    773:  spriteset_BR380_rear_ScotRail_Saltire;
    default: spriteset_BR380_front_ScotRail_Saltire;
}

// Reversed-role mapper based on mirrored consist vehicle type.
switch(FEAT_TRAINS, SELF, sw_BR380_rev_from_mirror, [STORE_TEMP(position_in_consist_from_end-position_in_consist, 0x10F), var[0x61, 0, 0x0000FFFF, 0xC6]]) {
    767:  spriteset_BR380_front_ScotRail_Saltire_reversed;
    768:  spriteset_BR380_front_ScotRail_Saltire_reversed;
    769:  spriteset_BR380_middle_panto_ScotRail_Saltire_reversed;
    770:  spriteset_BR380_rear_ScotRail_Saltire_reversed;
    771:  spriteset_BR380_middle_ScotRail_Saltire;
    772:  spriteset_BR380_middle_panto_ScotRail_Saltire_reversed;
    773:  spriteset_BR380_rear_ScotRail_Saltire_reversed;
    default: spriteset_BR380_front_ScotRail_Saltire_reversed;
}

switch(FEAT_TRAINS, PARENT, sw_BR380_pushpull, vehicle_is_reversed) {
    0: sw_BR380_role_from_vehicle;
    1: sw_BR380_rev_from_mirror;
}
